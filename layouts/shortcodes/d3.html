{{/*
Insert d3 plots into Markdown files.

Parameters
----------
script_path: Path to JS file.
data_path: Path to data used for draw function. If given, draw function in JS file is called with data.
div_id: ID of container used to hold plot.
*/}}

{{ $script_path := .Get "script_path" }}
{{ $data_path := .Get "data_path" }}
{{ $div_id := .Get "div_id" }}

{{/* Load d3 library */}}
<script src="https://d3js.org/d3.v7.js"></script>

{{/* Create a div where the plot will be inserted */}}
<div id="{{ $div_id }}"></div>

{{/* Call draw function if data_path is given */}}
{{ if $data_path }}
    <script type="module">
        import { draw } from "{{ (resources.Get $script_path).RelPermalink }}"
        fetch("{{ (resources.Get $data_path).RelPermalink }}")
            .then(response => response.json())
            .then(data => draw(data, "#{{ $div_id }}"))
    </script>
{{ else }}
    <script type="module">
        import { draw } from "{{ (resources.Get $script_path).RelPermalink }}"
        draw("#{{ $div_id }}")
    </script>
{{ end }}
